<!DOCTYPE html>
<html lang="ko" xmlns xmlns:th="http://www.w3.org/1999/xhtml" :th="http://thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>게시글 상세 화면</title>
    <script src="https://code.jquery.com//jquery-3.4.1.js"></script>
    <link th:href="@{/css/style.css}" rel="stylesheet" type="text/css">
</head>
<body>
<div class="container">
    <h2 class="title">게시글 작성</h2>
    <table class="board_detail">
        <tr class="detail_head head1">
            <td class="head_title">글 번호</td>
            <td th:text="${board.boardNum}"></td>
            <td class="head_title">조회수</td>
            <td th:text="${board.hitCnt}"></td>
        </tr>
        <tr class="detail_head head2">
            <td class="head_title">작성자</td>
            <td th:text="${board.writer}"></td>
            <td class="head_title">작성일</td>
            <td th:text="${board.createdTime}"></td>
        </tr>
        <tr class="detail_head head3">
            <td class="head_title">제목</td>
            <td class="head3_text" colspan="3"><input type="text" id="title" name="title" th:value="${board.title}"></td>
        </tr>
        <tr class="detail_head head4">
            <td class="head_title">내용</td>
            <td colspan="3"><textarea id="content" name="content" th:text="${board.content}"></textarea></td>
        </tr>
    </table>
    <div>
        <input type="hidden" id="boardNum" th:value="${board.boardNum}">
        <input class="detail_btn btn" type="button" value="목록" id="goBackList" onclick="history.back();">
        <input class="detail_btn btn" type="button" value="수정" id="update" onclick="updateBoard()">
        <input class="detail_btn btn" type="button" value="삭제" id="delete" onclick="deleteBoard()">
    </div>
</div>
</body>
</html>
<script>

    // const boardNum = $('#boardNum').val();
    const boardNum = document.getElementById("boardNum").value;

    function deleteBoard() {
        loadAjax('/board', 'DELETE', {boardNum: boardNum}, true);
    }

    function updateBoard() {

        const detailList = {
            title: document.getElementById("title").value,
            content: document.getElementById("content").value,
            boardNum: boardNum
        }

        loadAjax('/board', 'PUT', detailList, true);
    }

    function loadAjax(link, method, dataList, alertOK) {
        $.ajax({
            url: link,
            type: method,
            data: dataList,
            success: function () {
                if (alertOK) {
                    alert("성공 하였습니다.");
                    location.href="/boardListPage";
                }
            },
            error: function () {
                if (alertOK) {
                    alert("실패 하였습니다.")
                }
            }
        });
    }


</script>